#! /usr/bin/python3

import urllib
import urllib.request
from urllib.parse import urlencode, quote_plus
import json

print('''
 m    m        ""#                                 mmmm                      
 ##  ##  mmm     #   m     m  mmm    m mm   mmm   #"   "  mmm    mmm   m mm  
 # ## # "   #    #   "m m m" "   #   #"  " #"  #  "#mmm  #"  "  "   #  #"  # 
 # "" # m"""#    #    #m#m#  m"""#   #     #""""      "# #      m"""#  #   # 
 #    # "mm"#    "mm   # #   "mm"#   #     "#mm"  "mmm#" "#mm"  "mm"#  #   #   by Wam11''')                

print()
hash_value = input('Введите ваш хеш MD5 для сканирования: ')
print('Хэш получен!')
vt_url = "https://www.virustotal.com/vtapi/v2/file/report"
api_key = "5ede45e9a9cc89354ae2aa12738b64c0ac0106936c28a0c814db6d513607a514"

parameters = {'apikey':api_key, 'resource':hash_value}

encoded_parameters = urllib.parse.urlencode(parameters).encode("utf-8")
request = urllib.request.urlopen(vt_url, encoded_parameters)
#response = urllib.urlopen(request)
json_response = json.loads(request.read())

if json_response['response_code']:
    
    detections = json_response['positives']
    total = json_response['total']
    scan_results = json_response['scans']
    print("Detections: {0}{1}".format(detections, total))
    print("VirusTotal Results:")
    
    for av_name, av_data in scan_results.items():
        print("\t{0} ==> {1}".format(av_name, av_data['result']))
else:
    print("No AV Detections For: {}".format(hash_value))

print()
print()
print('-------Сканирование завершино!-------\n')

